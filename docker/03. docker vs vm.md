

## 가상 머신과 비교

<br>



### 가상화?

**가상화 이전**

- 한 대의 서버를 하나의 용도로만 사용(하나의 OS, 하나의 프로그램)하고 남는 공간은 방치됨

**가상화**

> 하이퍼 바이저 기반 가상화

- 논리적으로 하드웨어 공간을 분할해 Virtual Machine 이라는 독립적인 가상환경 서버를 만듬

- 논리적으로 분리되어있고 VM마다 적절한 CPU자원을 나눠 할당받아 VM들은 서로 격리되어있다.

**하이퍼바이저**

- 하이퍼 바이저는 호스트 시스템에서 다수의 OS를 구동할 수 있게 해줌

- `하드웨어` 를 가상화하면서 하드웨어와 VM들을 모니터링하는 중간 관리자임


### vs 도커

- 가상화 기술 기반으로 도커가 탄생(하드웨어에서 격리된 환경)

- VM과 달리 게스트 OS가 없어 더 가벼움

- 도커는 애플리케이션 실행을 위해 호스트 OS위에 도커 이미지 배포만 하면 되서 훨씬 가볍고 실행 과정이 간단함

![image](https://user-images.githubusercontent.com/76927397/184626033-dea92e23-f304-45e6-80e7-26a5275ecd5d.png)

<br>

**공통점**

- 기본 하드웨어와 애플리케이션 환경이 격리되어있다.

**차이점**

- 격리된 환경을 얼마나 격리시키나의 차이

> 컨테이너 내의 애플리케이션은 제공 격리 기능 내부에 샌드박스가 있으나 컨테이너들은 호스트 OS의 동일한 커널을 공유한다.

> 컨테이너 프로세스는 호스트 시스템에서 볼 수 있음

> 내장되는 guest OS 가 없기 때문에 가벼움 (5~100MB)

<br>

### 어떻게 컨테이너들을 격리시키나?

> 필요한 만큼의 CPU, 메모리 같은 자원을 제공해주는데 어떻게..??

> 리눅스 커널 기술인 `Cgroup(control group)` 과 `namespace` 사용

<br>

**Cgroup**

- CPU, 메모리, network bandwith 등 프로세스 그룹의 시스템 리소스 사용량을 관리

> 특정 애플리케이션을 Cgroup 에 포함시켜 리소스 자원 사용 제한 가능

**namespace**

- 하나의 시스템에서 프로세스를 격리시킬 수 있는 가상화 기술

- 독립된 공간을 사용하는 것 처럼 격리된 환경을 제공하는 경량 프로세스 가상화 기술


프로세스를 작동시키는데 필요한 양 만큼 리소스를 지원해주는 것이라고 볼 수 있다.


**내 OS에서 어떻게 리눅스 기술을?**

- 도커가 돌아갈 때 내 OS와 도커 컨테이너 사이에 리눅스 VM이 존재해 도커 클라이언트와 서버가 동작한다고 보면 된다.

```shell
docker version
```




